extern "C" __global__ void
calcNeuronValues(
    float *weight, 
    float *bias, 
    float *input, 
    float *output, 
	int outputRowCount,
	int outputColumnCount,
	int commonDim)
{
	int index = blockDim.x * blockIdx.x + threadIdx.x;
	int outputParamsCount = outputRowCount * outputColumnCount;
	
	if (index < outputParamsCount)
	{
        int x = index / outputRowCount;
		int y = index % outputRowCount;
		int i, j;

		float sum = 0.0f;
		
		for(int d = 0; d < commonDim; d++)
		{
            i = d * outputRowCount + y;
            j = x * commonDim + d;

            sum += weight[i] * input[j];
		}

		sum += bias[y];
		
		output[index] = 1.0f / (1.0f + __expf(-sum));
	}
}